<!DOCTYPE html><html lang="zh-TW"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>凱崴數位網站健檢報告 - 品耀數位行銷</title><link rel="stylesheet" href="../../css/projects/kaiwei/main.css"></head><body><!-- 登出按鈕--><div class="logout-container"><button class="logout-btn" onclick="logout()">登出</button></div><div class="presentation-container"><!-- 第1頁：空白投影片--><div class="slide"><h1>空白投影片</h1><p>開始您的簡報內容</p></div></div><div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div><div class="slide-navigation" id="slideNavigation"></div></body><script>// 登出功能
function logout() {
  sessionStorage.clear();
  window.location.href = '../../login.html';
}

// 垂直滾動簡報系統
document.addEventListener('DOMContentLoaded', function() {
  const slides = document.querySelectorAll('.slide');
  let currentSlide = 0;
  let isScrolling = false;
  let scrollTimeout;
  
  // 設定初始狀態
  slides.forEach((slide, index) => {
    slide.style.transform = `translateY(${index * 100}vh)`;
    slide.style.zIndex = slides.length - index;
  });
  
  // 顯示第一張投影片
  showSlide(0);
  
  // 監聽滾輪事件
  document.addEventListener('wheel', function(event) {
    if (isScrolling) return;
    
    isScrolling = true;
    clearTimeout(scrollTimeout);
    
    // 防止預設滾動行為
    event.preventDefault();
    
    if (event.deltaY > 0) {
      // 向下滾動 - 下一張
      if (currentSlide < slides.length - 1) {
        currentSlide++;
        showSlide(currentSlide);
      }
    } else {
      // 向上滾動 - 上一張
      if (currentSlide > 0) {
        currentSlide--;
        showSlide(currentSlide);
      }
    }
    
    // 重置滾動狀態
    scrollTimeout = setTimeout(() => {
      isScrolling = false;
    }, 600);
  }, { passive: false });
  
  // 監聽觸控事件
  let startY = 0;
  let startX = 0;
  
  document.addEventListener('touchstart', function(event) {
    startY = event.touches[0].clientY;
    startX = event.touches[0].clientX;
  }, { passive: true });
  
  document.addEventListener('touchend', function(event) {
    if (isScrolling) return;
    
    const endY = event.changedTouches[0].clientY;
    const endX = event.changedTouches[0].clientX;
    const diffY = startY - endY;
    const diffX = startX - endX;
    
    // 判斷是垂直滑動還是水平滑動
    if (Math.abs(diffY) > Math.abs(diffX)) {
      isScrolling = true;
      
      if (diffY > 50) {
        // 向上滑動 - 下一張
        if (currentSlide < slides.length - 1) {
          currentSlide++;
          showSlide(currentSlide);
        }
      } else if (diffY < -50) {
        // 向下滑動 - 上一張
        if (currentSlide > 0) {
          currentSlide--;
          showSlide(currentSlide);
        }
      }
      
      // 重置滾動狀態
      setTimeout(() => {
        isScrolling = false;
      }, 600);
    }
  }, { passive: true });
  
  // 監聽鍵盤事件
  document.addEventListener('keydown', function(event) {
    switch(event.key) {
      case 'ArrowDown':
      case ' ':
        event.preventDefault();
        if (currentSlide < slides.length - 1) {
          currentSlide++;
          showSlide(currentSlide);
        }
        break;
      case 'ArrowUp':
        event.preventDefault();
        if (currentSlide > 0) {
          currentSlide--;
          showSlide(currentSlide);
        }
        break;
      case 'Home':
        event.preventDefault();
        showSlide(0);
        break;
      case 'End':
        event.preventDefault();
        showSlide(slides.length - 1);
        break;
    }
  });
  
  // 顯示指定投影片
  function showSlide(index) {
    currentSlide = Math.max(0, Math.min(index, slides.length - 1));
    
    slides.forEach((slide, i) => {
      const offset = (i - currentSlide) * 100;
      slide.style.transform = `translateY(${offset}vh)`;
    });
    
    // 更新進度指示器
    updateProgress();
    updateNavigation();
  }
  
  // 更新進度指示器
  function updateProgress() {
    const progress = ((currentSlide + 1) / slides.length) * 100;
    const progressFill = document.getElementById('progressFill');
    progressFill.style.width = `${progress}%`;
  }
  
  // 創建導航指示器
  function createNavigation() {
    const nav = document.getElementById('slideNavigation');
    
    slides.forEach((_, index) => {
      const dot = document.createElement('div');
      dot.className = 'nav-dot';
      if (index === currentSlide) {
        dot.classList.add('active');
      }
      
      dot.addEventListener('click', () => {
        showSlide(index);
      });
      
      nav.appendChild(dot);
    });
  }
  
  // 更新導航點
  function updateNavigation() {
    const dots = document.querySelectorAll('.nav-dot');
    dots.forEach((dot, index) => {
      if (index === currentSlide) {
        dot.classList.add('active');
      } else {
        dot.classList.remove('active');
      }
    });
  }
  
  // 初始化導航
  createNavigation();
  
  // 防止頁面滾動
  document.body.style.overflow = 'hidden';
  
  // 響應式處理
  window.addEventListener('resize', function() {
    // 重新計算投影片位置
    slides.forEach((slide, i) => {
      const offset = (i - currentSlide) * 100;
      slide.style.transform = `translateY(${offset}vh)`;
    });
  });
});</script></html>