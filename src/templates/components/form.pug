//- 表單組件
.form-container
  form.login-form#loginForm
    .form-group
      label(for="username") 客戶帳號：
      input#username(type="text" name="username" placeholder="請輸入您的帳號" required)
    .form-group
      label(for="password") 專案案號：
      input#password(type="text" name="password" placeholder="請輸入您的案號" required)
    .form-actions
      button.btn-login(type="submit") 登入
    .error-message#errorMessage(style="display: none; color: red; margin-top: 10px; text-align: center;")

script.
  document.addEventListener('DOMContentLoaded', function() {
    const loginForm = document.getElementById('loginForm');
    if (loginForm) {
      // 載入客戶資料
      let clients = {};
      
      fetch('config/clients.json')
        .then(response => response.json())
        .then(data => {
          clients = data.clients;
        })
        .catch(error => {
          console.error('載入客戶資料失敗:', error);
          // 如果載入失敗，使用預設資料
          clients = {
            'kaiwei': {
              password: 'br08pj00625c08',
              projectPath: 'projects/kaiwei/index.html',
              displayName: '凱崴數位'
            }
          };
        });
      
      loginForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const username = document.getElementById('username').value.trim().toLowerCase();
        const password = document.getElementById('password').value.trim().toLowerCase();
        const errorMessage = document.getElementById('errorMessage');
        
        // 清除之前的錯誤訊息
        errorMessage.style.display = 'none';
        
        // 驗證客戶資料（大小寫不敏感）
        const client = clients[username];
        if (client && client.password.toLowerCase() === password) {
          // 登入成功，重定向到對應專案頁面
          window.location.href = client.projectPath;
        } else {
          // 登入失敗，顯示錯誤訊息
          errorMessage.textContent = '客戶名稱或案號錯誤，請重新輸入';
          errorMessage.style.display = 'block';
        }
      });
    }
  }); 
